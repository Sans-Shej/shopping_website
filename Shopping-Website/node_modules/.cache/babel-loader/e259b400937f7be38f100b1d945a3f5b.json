{"ast":null,"code":"// Utilities\nimport { computed } from 'vue';\nimport { deepEqual, getPropertyFromItem, pick, propsFactory } from \"../util/index.mjs\"; // Types\n// Composables\n\nexport const makeItemsProps = propsFactory({\n  items: {\n    type: Array,\n    default: () => []\n  },\n  itemTitle: {\n    type: [String, Array, Function],\n    default: 'title'\n  },\n  itemValue: {\n    type: [String, Array, Function],\n    default: 'value'\n  },\n  itemChildren: {\n    type: [Boolean, String, Array, Function],\n    default: 'children'\n  },\n  itemProps: {\n    type: [Boolean, String, Array, Function],\n    default: 'props'\n  },\n  returnObject: Boolean\n}, 'item');\nexport function transformItem(props, item) {\n  const title = getPropertyFromItem(item, props.itemTitle, item);\n  const value = props.returnObject ? item : getPropertyFromItem(item, props.itemValue, title);\n  const children = getPropertyFromItem(item, props.itemChildren);\n  const itemProps = props.itemProps === true ? typeof item === 'object' && item != null && !Array.isArray(item) ? 'children' in item ? pick(item, ['children'])[1] : item : undefined : getPropertyFromItem(item, props.itemProps);\n  const _props = {\n    title,\n    value,\n    ...itemProps\n  };\n  return {\n    title: String(_props.title ?? ''),\n    value: _props.value,\n    props: _props,\n    children: Array.isArray(children) ? transformItems(props, children) : undefined,\n    raw: item\n  };\n}\nexport function transformItems(props, items) {\n  const array = [];\n\n  for (const item of items) {\n    array.push(transformItem(props, item));\n  }\n\n  return array;\n}\nexport function useItems(props) {\n  const items = computed(() => transformItems(props, props.items));\n\n  function transformIn(value) {\n    return value.map(v => {\n      const existingItem = items.value.find(item => deepEqual(v, item.value)); // Nullish existingItem means value is a custom input value from combobox\n      // In this case, use transformItem to create an InternalItem based on value\n\n      return existingItem ?? transformItem(props, v);\n    });\n  }\n\n  function transformOut(value) {\n    return value.map(_ref => {\n      let {\n        props\n      } = _ref;\n      return props.value;\n    });\n  }\n\n  return {\n    items,\n    transformIn,\n    transformOut\n  };\n}","map":{"version":3,"mappings":"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","names":["computed","deepEqual","getPropertyFromItem","pick","propsFactory","makeItemsProps","items","type","Array","default","itemTitle","String","Function","itemValue","itemChildren","Boolean","itemProps","returnObject","transformItem","props","item","title","value","children","isArray","undefined","_props","transformItems","raw","array","push","useItems","transformIn","map","v","existingItem","find","transformOut","_ref"],"sources":["../../src/composables/items.ts"],"sourcesContent":["// Utilities\nimport { computed } from 'vue'\nimport { deepEqual, getPropertyFromItem, pick, propsFactory } from '@/util'\n\n// Types\nimport type { PropType } from 'vue'\nimport type { SelectItemKey } from '@/util'\n\nexport interface InternalItem<T = any> {\n  title: string\n  value: any\n  props: {\n    [key: string]: any\n    title: string\n    value: any\n  }\n  children?: InternalItem<T>[]\n  raw: T\n}\n\nexport interface ItemProps {\n  items: any[]\n  itemTitle: SelectItemKey\n  itemValue: SelectItemKey\n  itemChildren: SelectItemKey\n  itemProps: SelectItemKey\n  returnObject: boolean\n}\n\n// Composables\nexport const makeItemsProps = propsFactory({\n  items: {\n    type: Array as PropType<ItemProps['items']>,\n    default: () => ([]),\n  },\n  itemTitle: {\n    type: [String, Array, Function] as PropType<SelectItemKey>,\n    default: 'title',\n  },\n  itemValue: {\n    type: [String, Array, Function] as PropType<SelectItemKey>,\n    default: 'value',\n  },\n  itemChildren: {\n    type: [Boolean, String, Array, Function] as PropType<SelectItemKey>,\n    default: 'children',\n  },\n  itemProps: {\n    type: [Boolean, String, Array, Function] as PropType<SelectItemKey>,\n    default: 'props',\n  },\n  returnObject: Boolean,\n}, 'item')\n\nexport function transformItem (props: Omit<ItemProps, 'items'>, item: any) {\n  const title = getPropertyFromItem(item, props.itemTitle, item)\n  const value = props.returnObject ? item : getPropertyFromItem(item, props.itemValue, title)\n  const children = getPropertyFromItem(item, props.itemChildren)\n  const itemProps = props.itemProps === true\n    ? typeof item === 'object' && item != null && !Array.isArray(item)\n      ? 'children' in item\n        ? pick(item, ['children'])[1]\n        : item\n      : undefined\n    : getPropertyFromItem(item, props.itemProps)\n\n  const _props = {\n    title,\n    value,\n    ...itemProps,\n  }\n\n  return {\n    title: String(_props.title ?? ''),\n    value: _props.value,\n    props: _props,\n    children: Array.isArray(children) ? transformItems(props, children) : undefined,\n    raw: item,\n  }\n}\n\nexport function transformItems (props: Omit<ItemProps, 'items'>, items: ItemProps['items']) {\n  const array: InternalItem[] = []\n\n  for (const item of items) {\n    array.push(transformItem(props, item))\n  }\n\n  return array\n}\n\nexport function useItems (props: ItemProps) {\n  const items = computed(() => transformItems(props, props.items))\n\n  function transformIn (value: any[]): InternalItem[] {\n    return value.map(v => {\n      const existingItem = items.value.find(item => deepEqual(v, item.value))\n      // Nullish existingItem means value is a custom input value from combobox\n      // In this case, use transformItem to create an InternalItem based on value\n      return existingItem ?? transformItem(props, v)\n    })\n  }\n\n  function transformOut (value: InternalItem[]) {\n    return value.map(({ props }) => props.value)\n  }\n\n  return { items, transformIn, transformOut }\n}\n"]},"metadata":{},"sourceType":"module"}