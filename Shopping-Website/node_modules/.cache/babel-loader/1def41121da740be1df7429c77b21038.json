{"ast":null,"code":"import { createTextVNode as _createTextVNode, createVNode as _createVNode, Fragment as _Fragment } from \"vue\"; // Styles\n\nimport \"./VRating.css\"; // Components\n\nimport { VBtn } from \"../VBtn/index.mjs\"; // Composables\n\nimport { IconValue } from \"../../composables/icons.mjs\";\nimport { makeDensityProps } from \"../../composables/density.mjs\";\nimport { makeSizeProps } from \"../../composables/size.mjs\";\nimport { makeTagProps } from \"../../composables/tag.mjs\";\nimport { makeThemeProps, provideTheme } from \"../../composables/theme.mjs\";\nimport { useLocale } from \"../../composables/locale.mjs\";\nimport { useProxiedModel } from \"../../composables/proxiedModel.mjs\"; // Utilities\n\nimport { computed, ref } from 'vue';\nimport { clamp, createRange, genericComponent, getUid, useRender } from \"../../util/index.mjs\"; // Types\n\nexport const VRating = genericComponent()({\n  name: 'VRating',\n  props: {\n    name: String,\n    itemAriaLabel: {\n      type: String,\n      default: '$vuetify.rating.ariaLabel.item'\n    },\n    activeColor: String,\n    color: String,\n    clearable: Boolean,\n    disabled: Boolean,\n    emptyIcon: {\n      type: IconValue,\n      default: '$ratingEmpty'\n    },\n    fullIcon: {\n      type: IconValue,\n      default: '$ratingFull'\n    },\n    halfIncrements: Boolean,\n    hover: Boolean,\n    length: {\n      type: [Number, String],\n      default: 5\n    },\n    readonly: Boolean,\n    modelValue: {\n      type: [Number, String],\n      default: 0\n    },\n    itemLabels: Array,\n    itemLabelPosition: {\n      type: String,\n      default: 'top',\n      validator: v => ['top', 'bottom'].includes(v)\n    },\n    ripple: Boolean,\n    ...makeDensityProps(),\n    ...makeSizeProps(),\n    ...makeTagProps(),\n    ...makeThemeProps()\n  },\n  emits: {\n    'update:modelValue': value => true\n  },\n\n  setup(props, _ref) {\n    let {\n      slots\n    } = _ref;\n    const {\n      t\n    } = useLocale();\n    const {\n      themeClasses\n    } = provideTheme(props);\n    const rating = useProxiedModel(props, 'modelValue');\n    const normalizedValue = computed(() => clamp(parseFloat(rating.value), 0, +props.length));\n    const range = computed(() => createRange(Number(props.length), 1));\n    const increments = computed(() => range.value.flatMap(v => props.halfIncrements ? [v - 0.5, v] : [v]));\n    const hoverIndex = ref(-1);\n    const focusIndex = ref(-1);\n    const firstRef = ref();\n    let isClicking = false;\n    const itemState = computed(() => increments.value.map(value => {\n      const isHovering = props.hover && hoverIndex.value > -1;\n      const isFilled = normalizedValue.value >= value;\n      const isHovered = hoverIndex.value >= value;\n      const isFullIcon = isHovering ? isHovered : isFilled;\n      const icon = isFullIcon ? props.fullIcon : props.emptyIcon;\n      const activeColor = props.activeColor ?? props.color;\n      const color = isFilled || isHovered ? activeColor : props.color;\n      return {\n        isFilled,\n        isHovered,\n        icon,\n        color\n      };\n    }));\n    const eventState = computed(() => [0, ...increments.value].map(value => {\n      function onMouseenter() {\n        hoverIndex.value = value;\n      }\n\n      function onMouseleave() {\n        hoverIndex.value = -1;\n      }\n\n      function onFocus() {\n        if (value === 0 && normalizedValue.value === 0) {\n          firstRef.value?.focus();\n        } else {\n          focusIndex.value = value;\n        }\n      }\n\n      function onBlur() {\n        if (!isClicking) focusIndex.value = -1;\n      }\n\n      function onClick() {\n        if (props.disabled || props.readonly) return;\n        rating.value = normalizedValue.value === value && props.clearable ? 0 : value;\n      }\n\n      return {\n        onMouseenter: props.hover ? onMouseenter : undefined,\n        onMouseleave: props.hover ? onMouseleave : undefined,\n        onFocus,\n        onBlur,\n        onClick\n      };\n    }));\n\n    function onMousedown() {\n      isClicking = true;\n    }\n\n    function onMouseup() {\n      isClicking = false;\n    }\n\n    const name = computed(() => props.name ?? `v-rating-${getUid()}`);\n\n    function VRatingItem(_ref2) {\n      let {\n        value,\n        index,\n        showStar = true\n      } = _ref2;\n      const {\n        onMouseenter,\n        onMouseleave,\n        onFocus,\n        onBlur,\n        onClick\n      } = eventState.value[index + 1];\n      const id = `${name.value}-${String(value).replace('.', '-')}`;\n      const btnProps = {\n        color: itemState.value[index]?.color,\n        density: props.density,\n        disabled: props.disabled,\n        icon: itemState.value[index]?.icon,\n        ripple: props.ripple,\n        size: props.size,\n        tag: 'span',\n        variant: 'plain'\n      };\n      return _createVNode(_Fragment, null, [_createVNode(\"label\", {\n        \"for\": id,\n        \"class\": {\n          'v-rating__item--half': props.halfIncrements && value % 1 > 0,\n          'v-rating__item--full': props.halfIncrements && value % 1 === 0\n        },\n        \"onMousedown\": onMousedown,\n        \"onMouseup\": onMouseup,\n        \"onMouseenter\": onMouseenter,\n        \"onMouseleave\": onMouseleave\n      }, [_createVNode(\"span\", {\n        \"class\": \"v-rating__hidden\"\n      }, [t(props.itemAriaLabel, value, props.length)]), !showStar ? undefined : slots.item ? slots.item({ ...itemState.value[index],\n        props: btnProps,\n        value,\n        index\n      }) : _createVNode(VBtn, btnProps, null)]), _createVNode(\"input\", {\n        \"class\": \"v-rating__hidden\",\n        \"name\": name.value,\n        \"id\": id,\n        \"type\": \"radio\",\n        \"value\": value,\n        \"checked\": normalizedValue.value === value,\n        \"onClick\": onClick,\n        \"onFocus\": onFocus,\n        \"onBlur\": onBlur,\n        \"ref\": index === 0 ? firstRef : undefined,\n        \"readonly\": props.readonly,\n        \"disabled\": props.disabled\n      }, null)]);\n    }\n\n    function createLabel(labelProps) {\n      if (slots['item-label']) return slots['item-label'](labelProps);\n      if (labelProps.label) return _createVNode(\"span\", null, [labelProps.label]);\n      return _createVNode(\"span\", null, [_createTextVNode(\"\\xA0\")]);\n    }\n\n    useRender(() => {\n      const hasLabels = !!props.itemLabels?.length || slots['item-label'];\n      return _createVNode(props.tag, {\n        \"class\": ['v-rating', {\n          'v-rating--hover': props.hover,\n          'v-rating--readonly': props.readonly\n        }, themeClasses.value]\n      }, {\n        default: () => [_createVNode(VRatingItem, {\n          \"value\": 0,\n          \"index\": -1,\n          \"showStar\": false\n        }, null), range.value.map((value, i) => _createVNode(\"div\", {\n          \"class\": \"v-rating__wrapper\"\n        }, [hasLabels && props.itemLabelPosition === 'top' ? createLabel({\n          value,\n          index: i,\n          label: props.itemLabels?.[i]\n        }) : undefined, _createVNode(\"div\", {\n          \"class\": ['v-rating__item', {\n            'v-rating__item--focused': Math.ceil(focusIndex.value) === value\n          }]\n        }, [props.halfIncrements ? _createVNode(_Fragment, null, [_createVNode(VRatingItem, {\n          \"value\": value - 0.5,\n          \"index\": i * 2\n        }, null), _createVNode(VRatingItem, {\n          \"value\": value,\n          \"index\": i * 2 + 1\n        }, null)]) : _createVNode(VRatingItem, {\n          \"value\": value,\n          \"index\": i\n        }, null)]), hasLabels && props.itemLabelPosition === 'bottom' ? createLabel({\n          value,\n          index: i,\n          label: props.itemLabels?.[i]\n        }) : undefined]))]\n      });\n    });\n    return {};\n  }\n\n});","map":{"version":3,"mappings":"+GAAA;;AACA,uB,CAEA;;AAAA,SACSA,IADT,QACa,mBADb,C,CAGA;;AAAA,SACSC,SADT,QACkB,6BADlB;AACkB,SACTC,gBADS,QACO,+BADP;AACO,SAChBC,aADgB,QACH,4BADG;AACH,SACbC,YADa,QACD,2BADC;AACD,SACZC,cADY,EACIC,YADJ,QACgB,6BADhB;AACgB,SAC5BC,SAD4B,QACnB,8BADmB;AACnB,SACTC,eADS,QACM,oCADN,C,CAGlB;;AACA,SAASC,QAAT,EAAmBC,GAAnB,QAA8B,KAA9B;AAAmC,SAC1BC,KAD0B,EACnBC,WADmB,EACNC,gBADM,EACYC,MADZ,EACoBC,SADpB,QAC6B,sBAD7B,C,CAGnC;;AAyBA,OAAO,MAAMC,OAAO,GAAGH,gBAAgB,GAAiB;EACtDI,IAAI,EAAE,SADgD;EAGtDC,KAAK,EAAE;IACLD,IAAI,EAAEE,MADD;IAELC,aAAa,EAAE;MACbC,IAAI,EAAEF,MADO;MAEbG,OAAO,EAAE;IAFI,CAFV;IAMLC,WAAW,EAAEJ,MANR;IAOLK,KAAK,EAAEL,MAPF;IAQLM,SAAS,EAAEC,OARN;IASLC,QAAQ,EAAED,OATL;IAULE,SAAS,EAAE;MACTP,IAAI,EAAEpB,SADG;MAETqB,OAAO,EAAE;IAFA,CAVN;IAcLO,QAAQ,EAAE;MACRR,IAAI,EAAEpB,SADE;MAERqB,OAAO,EAAE;IAFD,CAdL;IAkBLQ,cAAc,EAAEJ,OAlBX;IAmBLK,KAAK,EAAEL,OAnBF;IAoBLM,MAAM,EAAE;MACNX,IAAI,EAAE,CAACY,MAAD,EAASd,MAAT,CADA;MAENG,OAAO,EAAE;IAFH,CApBH;IAwBLY,QAAQ,EAAER,OAxBL;IAyBLS,UAAU,EAAE;MACVd,IAAI,EAAE,CAACY,MAAD,EAASd,MAAT,CADI;MAEVG,OAAO,EAAE;IAFC,CAzBP;IA6BLc,UAAU,EAAEC,KA7BP;IA8BLC,iBAAiB,EAAE;MACjBjB,IAAI,EAAEF,MADW;MAEjBG,OAAO,EAAE,KAFQ;MAGjBiB,SAAS,EAAGC,CAAM,IAAK,CAAC,KAAD,EAAQ,QAAR,EAAkBC,QAAlB,CAA2BD,CAA3B;IAHN,CA9Bd;IAmCLE,MAAM,EAAEhB,OAnCH;IAqCL,GAAGxB,gBAAgB,EArCd;IAsCL,GAAGC,aAAa,EAtCX;IAuCL,GAAGC,YAAY,EAvCV;IAwCL,GAAGC,cAAc;EAxCZ,CAH+C;EA8CtDsC,KAAK,EAAE;IACL,qBAAsBC,KAAsB,IAAK;EAD5C,CA9C+C;;EAkDtDC,KAAKA,CAAE3B,KAAF2B,EAAOC,IAAPD,EAAoB;IAAA,IAAX;MAAEE;IAAF,IAASD,IAAE;IACvB,MAAM;MAAEE;IAAF,IAAQzC,SAAS,EAAvB;IACA,MAAM;MAAE0C;IAAF,IAAmB3C,YAAY,CAACY,KAAD,CAArC;IACA,MAAMgC,MAAM,GAAG1C,eAAe,CAACU,KAAD,EAAQ,YAAR,CAA9B;IACA,MAAMiC,eAAe,GAAG1C,QAAQ,CAAC,MAAME,KAAK,CAACyC,UAAU,CAACF,MAAM,CAACN,KAAR,CAAX,EAA2B,CAA3B,EAA8B,CAAC1B,KAAK,CAACc,MAArC,CAAZ,CAAhC;IAEA,MAAMqB,KAAK,GAAG5C,QAAQ,CAAC,MAAMG,WAAW,CAACqB,MAAM,CAACf,KAAK,CAACc,MAAP,CAAP,EAAuB,CAAvB,CAAlB,CAAtB;IACA,MAAMsB,UAAU,GAAG7C,QAAQ,CAAC,MAAM4C,KAAK,CAACT,KAANS,CAAYE,OAAZF,CAAoBb,CAAC,IAAItB,KAAK,CAACY,cAANZ,GAAuB,CAACsB,CAAC,GAAG,GAAL,EAAUA,CAAV,CAAvBtB,GAAsC,CAACsB,CAAD,CAA/Da,CAAP,CAA3B;IACA,MAAMG,UAAU,GAAG9C,GAAG,CAAC,CAAC,CAAF,CAAtB;IACA,MAAM+C,UAAU,GAAG/C,GAAG,CAAC,CAAC,CAAF,CAAtB;IACA,MAAMgD,QAAQ,GAAGhD,GAAG,EAApB;IACA,IAAIiD,UAAU,GAAG,KAAjB;IAEA,MAAMC,SAAS,GAAGnD,QAAQ,CAAC,MAAM6C,UAAU,CAACV,KAAXU,CAAiBO,GAAjBP,CAAqBV,KAAK,IAAI;MAC7D,MAAMkB,UAAU,GAAG5C,KAAK,CAACa,KAANb,IAAesC,UAAU,CAACZ,KAAXY,GAAmB,CAAC,CAAtD;MACA,MAAMO,QAAQ,GAAGZ,eAAe,CAACP,KAAhBO,IAAyBP,KAA1C;MACA,MAAMoB,SAAS,GAAGR,UAAU,CAACZ,KAAXY,IAAoBZ,KAAtC;MACA,MAAMqB,UAAU,GAAGH,UAAU,GAAGE,SAAH,GAAeD,QAA5C;MACA,MAAMG,IAAI,GAAGD,UAAU,GAAG/C,KAAK,CAACW,QAAT,GAAoBX,KAAK,CAACU,SAAjD;MACA,MAAML,WAAW,GAAGL,KAAK,CAACK,WAANL,IAAqBA,KAAK,CAACM,KAA/C;MACA,MAAMA,KAAK,GAAIuC,QAAQ,IAAIC,SAAZD,GAAyBxC,WAAzBwC,GAAuC7C,KAAK,CAACM,KAA5D;MAEA,OAAO;QAAEuC,QAAF;QAAYC,SAAZ;QAAuBE,IAAvB;QAA6B1C;MAA7B,CAAP;IACD,CAVgC8B,CAAP,CAA1B;IAYA,MAAMa,UAAU,GAAG1D,QAAQ,CAAC,MAAM,CAAC,CAAD,EAAI,GAAG6C,UAAU,CAACV,KAAlB,EAAyBiB,GAAzB,CAA6BjB,KAAK,IAAI;MACtE,SAASwB,YAAT,GAAyB;QACvBZ,UAAU,CAACZ,KAAXY,GAAmBZ,KAAnBY;MACF;;MAEA,SAASa,YAAT,GAAyB;QACvBb,UAAU,CAACZ,KAAXY,GAAmB,CAAC,CAApBA;MACF;;MAEA,SAASc,OAAT,GAAoB;QAClB,IAAI1B,KAAK,KAAK,CAAVA,IAAeO,eAAe,CAACP,KAAhBO,KAA0B,CAA7C,EAAgD;UAC9CO,QAAQ,CAACd,KAATc,EAAgBa,KAAhBb;QACD,CAFD,MAEO;UACLD,UAAU,CAACb,KAAXa,GAAmBb,KAAnBa;QACF;MACF;;MAEA,SAASe,MAAT,GAAmB;QACjB,IAAI,CAACb,UAAL,EAAiBF,UAAU,CAACb,KAAXa,GAAmB,CAAC,CAApBA;MACnB;;MAEA,SAASgB,OAAT,GAAoB;QAClB,IAAIvD,KAAK,CAACS,QAANT,IAAkBA,KAAK,CAACgB,QAA5B,EAAsC;QACtCgB,MAAM,CAACN,KAAPM,GAAeC,eAAe,CAACP,KAAhBO,KAA0BP,KAA1BO,IAAmCjC,KAAK,CAACO,SAAzC0B,GAAqD,CAArDA,GAAyDP,KAAxEM;MACF;;MAEA,OAAO;QACLkB,YAAY,EAAElD,KAAK,CAACa,KAANb,GAAckD,YAAdlD,GAA6BwD,SADtC;QAELL,YAAY,EAAEnD,KAAK,CAACa,KAANb,GAAcmD,YAAdnD,GAA6BwD,SAFtC;QAGLJ,OAHK;QAILE,MAJK;QAKLC;MALK,CAAP;IAOD,CAjCiC,CAAP,CAA3B;;IAmCA,SAASE,WAAT,GAAwB;MACtBhB,UAAU,GAAG,IAAbA;IACF;;IAEA,SAASiB,SAAT,GAAsB;MACpBjB,UAAU,GAAG,KAAbA;IACF;;IAEA,MAAM1C,IAAI,GAAGR,QAAQ,CAAC,MAAMS,KAAK,CAACD,IAANC,IAAe,YAAWJ,MAAM,EAAG,EAA1C,CAArB;;IAEA,SAAS+D,WAAT,CAAoBC,KAApB,EAA+G;MAAA,IAAzF;QAAElC,KAAF;QAASmC,KAAT;QAAgBC,QAAQ,GAAG;MAA3B,IAAuFF,KAAE;MAC7G,MAAM;QAAEV,YAAF;QAAgBC,YAAhB;QAA8BC,OAA9B;QAAuCE,MAAvC;QAA+CC;MAA/C,IAA2DN,UAAU,CAACvB,KAAXuB,CAAiBY,KAAK,GAAG,CAAzBZ,CAAjE;MACA,MAAMc,EAAE,GAAI,GAAEhE,IAAI,CAAC2B,KAAM,IAAGzB,MAAM,CAACyB,KAAD,CAANzB,CAAc+D,OAAd/D,CAAsB,GAAtBA,EAA2B,GAA3BA,CAAgC,EAA5D;MACA,MAAMgE,QAAQ,GAAG;QACf3D,KAAK,EAAEoC,SAAS,CAAChB,KAAVgB,CAAgBmB,KAAhBnB,GAAwBpC,KADhB;QAEf4D,OAAO,EAAElE,KAAK,CAACkE,OAFA;QAGfzD,QAAQ,EAAET,KAAK,CAACS,QAHD;QAIfuC,IAAI,EAAEN,SAAS,CAAChB,KAAVgB,CAAgBmB,KAAhBnB,GAAwBM,IAJf;QAKfxB,MAAM,EAAExB,KAAK,CAACwB,MALC;QAMf2C,IAAI,EAAEnE,KAAK,CAACmE,IANG;QAOfC,GAAG,EAAE,MAPU;QAQfC,OAAO,EAAE;MARM,CAAjB;MAWA;QAAA,OAGYN,EAHZ;QAGc,SACD;UACL,wBAAwB/D,KAAK,CAACY,cAANZ,IAAwB0B,KAAK,GAAG,CAARA,GAAY,CADvD;UAEL,wBAAwB1B,KAAK,CAACY,cAANZ,IAAwB0B,KAAK,GAAG,CAARA,KAAc;QAFzD,CAJb;QAOO,eACa+B,WARpB;QAQ+B,aACbC,SATlB;QAS2B,gBACNR,YAVrB;QAUiC,gBACZC;MAXrB,GAWiC;QAAA,SAEf;MAFe,GAEG,CAAGrB,CAAC,CAAC9B,KAAK,CAACE,aAAP,EAAsBwB,KAAtB,EAA6B1B,KAAK,CAACc,MAAnC,CAAJ,CAFH,GAIzB,CAACgD,QAAD,GAAYN,SAAZ,GACE3B,KAAK,CAACyC,IAANzC,GAAaA,KAAK,CAACyC,IAANzC,CAAW,EACxB,GAAGa,SAAS,CAAChB,KAAVgB,CAAgBmB,KAAhBnB,CADqB;QAExB1C,KAAK,EAAEiE,QAFiB;QAGxBvC,KAHwB;QAIxBmC;MAJwB,CAAXhC,CAAbA,GAKA0C,mBAEWN,QAFX,EAEmB,IAFnB,CAVuB,CAXjC,GAwBSM;QAAA,SAKG,kBALH;QAKqB,QACjBxE,IAAI,CAAC2B,KANT;QAMc,MACZqC,EAPF;QAOI,QACF,OARF;QAQS,SACJrC,KATL;QASU,WACHO,eAAe,CAACP,KAAhBO,KAA0BP,KAVjC;QAUsC,WAC/B6B,OAXP;QAWc,WACPH,OAZP;QAYc,UACRE,MAbN;QAaY,OACTO,KAAK,KAAK,CAAVA,GAAcrB,QAAdqB,GAAyBL,SAd5B;QAcqC,YAC7BxD,KAAK,CAACgB,QAfd;QAesB,YACdhB,KAAK,CAACS;MAhBd,GAgBsB,IAhBtB,CAxBT;IA4CF;;IAEA,SAAS+D,WAAT,CAAsBC,UAAtB,EAAoF;MAClF,IAAI5C,KAAK,CAAC,YAAD,CAAT,EAAyB,OAAOA,KAAK,CAAC,YAAD,CAALA,CAAoB4C,UAApB5C,CAAP;MAEzB,IAAI4C,UAAU,CAACC,KAAf,EAAsB,mCAAeD,UAAU,CAACC,KAA1B;MAEtB;IACF;;IAEA7E,SAAS,CAAC,MAAM;MACd,MAAM8E,SAAS,GAAG,CAAC,CAAC3E,KAAK,CAACkB,UAANlB,EAAkBc,MAApB,IAA8Be,KAAK,CAAC,YAAD,CAArD;MAEA;QAAA,SAEW,CACL,UADK,EAEL;UACE,mBAAmB7B,KAAK,CAACa,KAD3B;UAEE,sBAAsBb,KAAK,CAACgB;QAF9B,CAFK,EAMLe,YAAY,CAACL,KANR;MAFX,GASK;QAAAtB;UAAA,SAEoB,CAFpB;UAEqB,SAAW,CAAC,CAFjC;UAEkC,YAAc;QAFhD,GAEqD,IAFrD,GAIC+B,KAAK,CAACT,KAANS,CAAYQ,GAAZR,CAAgB,CAACT,KAAD,EAAQkD,CAAR,KAASL;UAAA,SACd;QADc,GACK,CAE1BI,SAAS,IAAI3E,KAAK,CAACoB,iBAANpB,KAA4B,KAAzC2E,GACIH,WAAW,CAAC;UAAE9C,KAAF;UAASmC,KAAK,EAAEe,CAAhB;UAAmBF,KAAK,EAAE1E,KAAK,CAACkB,UAANlB,GAAmB4E,CAAnB5E;QAA1B,CAAD,CADf2E,GAEInB,SAJsB,EAIbe;UAAA,SAGN,CACL,gBADK,EAEL;YACE,2BAA2BM,IAAI,CAACC,IAALD,CAAUtC,UAAU,CAACb,KAArBmD,MAAgCnD;UAD7D,CAFK;QAHM,GAQZ,CAEC1B,KAAK,CAACY,cAANZ,GAAoBuE;UAAA,SAEG7C,KAAK,GAAG,GAFX;UAEc,SAAWkD,CAAC,GAAG;QAF7B,GAE8B,IAF9B,GAE8BL;UAAA,SAC3B7C,KAD2B;UACtB,SAAYkD,CAAC,GAAG,CAAJA,GAAS;QADC,GACA,IADA,CAF9B,EAApB5E,GAGkDuE;UAAA,SAG7B7C,KAH6B;UAGxB,SAAWkD;QAHa,GAGZ,IAHY,CALnD,CARY,CAJa,EAwB1BD,SAAS,IAAI3E,KAAK,CAACoB,iBAANpB,KAA4B,QAAzC2E,GACIH,WAAW,CAAC;UAAE9C,KAAF;UAASmC,KAAK,EAAEe,CAAhB;UAAmBF,KAAK,EAAE1E,KAAK,CAACkB,UAANlB,GAAmB4E,CAAnB5E;QAA1B,CAAD,CADf2E,GAEInB,SA1BsB,CADL,CAAzBrB,CAJD;MAAA,CATL;IA8CD,CAjDQ,CAATtC;IAmDA,OAAO,EAAP;EACF;;AAhPsD,CAAjB,CAAhC","names":["VBtn","IconValue","makeDensityProps","makeSizeProps","makeTagProps","makeThemeProps","provideTheme","useLocale","useProxiedModel","computed","ref","clamp","createRange","genericComponent","getUid","useRender","VRating","name","props","String","itemAriaLabel","type","default","activeColor","color","clearable","Boolean","disabled","emptyIcon","fullIcon","halfIncrements","hover","length","Number","readonly","modelValue","itemLabels","Array","itemLabelPosition","validator","v","includes","ripple","emits","value","setup","_ref","slots","t","themeClasses","rating","normalizedValue","parseFloat","range","increments","flatMap","hoverIndex","focusIndex","firstRef","isClicking","itemState","map","isHovering","isFilled","isHovered","isFullIcon","icon","eventState","onMouseenter","onMouseleave","onFocus","focus","onBlur","onClick","undefined","onMousedown","onMouseup","VRatingItem","_ref2","index","showStar","id","replace","btnProps","density","size","tag","variant","item","_createVNode","createLabel","labelProps","label","hasLabels","i","Math","ceil"],"sources":["../../../src/components/VRating/VRating.tsx"],"sourcesContent":["// Styles\nimport './VRating.sass'\n\n// Components\nimport { VBtn } from '@/components/VBtn'\n\n// Composables\nimport { IconValue } from '@/composables/icons'\nimport { makeDensityProps } from '@/composables/density'\nimport { makeSizeProps } from '@/composables/size'\nimport { makeTagProps } from '@/composables/tag'\nimport { makeThemeProps, provideTheme } from '@/composables/theme'\nimport { useLocale } from '@/composables/locale'\nimport { useProxiedModel } from '@/composables/proxiedModel'\n\n// Utilities\nimport { computed, ref } from 'vue'\nimport { clamp, createRange, genericComponent, getUid, useRender } from '@/util'\n\n// Types\nimport type { Prop } from 'vue'\nimport type { Variant } from '@/composables/variant'\n\ntype VRatingItemSlot = {\n  value: number\n  index: number\n  isFilled: boolean\n  isHovered: boolean\n  icon: IconValue\n  color?: string\n  props: Record<string, unknown>\n}\n\ntype VRatingItemLabelSlot = {\n  value: number\n  index: number\n  label?: string\n}\n\ntype VRatingSlots = {\n  item: [VRatingItemSlot]\n  'item-label': [VRatingItemLabelSlot]\n}\n\nexport const VRating = genericComponent<VRatingSlots>()({\n  name: 'VRating',\n\n  props: {\n    name: String,\n    itemAriaLabel: {\n      type: String,\n      default: '$vuetify.rating.ariaLabel.item',\n    },\n    activeColor: String,\n    color: String,\n    clearable: Boolean,\n    disabled: Boolean,\n    emptyIcon: {\n      type: IconValue,\n      default: '$ratingEmpty',\n    },\n    fullIcon: {\n      type: IconValue,\n      default: '$ratingFull',\n    },\n    halfIncrements: Boolean,\n    hover: Boolean,\n    length: {\n      type: [Number, String],\n      default: 5,\n    },\n    readonly: Boolean,\n    modelValue: {\n      type: [Number, String],\n      default: 0,\n    },\n    itemLabels: Array as Prop<string[]>,\n    itemLabelPosition: {\n      type: String,\n      default: 'top',\n      validator: (v: any) => ['top', 'bottom'].includes(v),\n    },\n    ripple: Boolean,\n\n    ...makeDensityProps(),\n    ...makeSizeProps(),\n    ...makeTagProps(),\n    ...makeThemeProps(),\n  },\n\n  emits: {\n    'update:modelValue': (value: number | string) => true,\n  },\n\n  setup (props, { slots }) {\n    const { t } = useLocale()\n    const { themeClasses } = provideTheme(props)\n    const rating = useProxiedModel(props, 'modelValue')\n    const normalizedValue = computed(() => clamp(parseFloat(rating.value), 0, +props.length))\n\n    const range = computed(() => createRange(Number(props.length), 1))\n    const increments = computed(() => range.value.flatMap(v => props.halfIncrements ? [v - 0.5, v] : [v]))\n    const hoverIndex = ref(-1)\n    const focusIndex = ref(-1)\n    const firstRef = ref<HTMLElement>()\n    let isClicking = false\n\n    const itemState = computed(() => increments.value.map(value => {\n      const isHovering = props.hover && hoverIndex.value > -1\n      const isFilled = normalizedValue.value >= value\n      const isHovered = hoverIndex.value >= value\n      const isFullIcon = isHovering ? isHovered : isFilled\n      const icon = isFullIcon ? props.fullIcon : props.emptyIcon\n      const activeColor = props.activeColor ?? props.color\n      const color = (isFilled || isHovered) ? activeColor : props.color\n\n      return { isFilled, isHovered, icon, color }\n    }))\n\n    const eventState = computed(() => [0, ...increments.value].map(value => {\n      function onMouseenter () {\n        hoverIndex.value = value\n      }\n\n      function onMouseleave () {\n        hoverIndex.value = -1\n      }\n\n      function onFocus () {\n        if (value === 0 && normalizedValue.value === 0) {\n          firstRef.value?.focus()\n        } else {\n          focusIndex.value = value\n        }\n      }\n\n      function onBlur () {\n        if (!isClicking) focusIndex.value = -1\n      }\n\n      function onClick () {\n        if (props.disabled || props.readonly) return\n        rating.value = normalizedValue.value === value && props.clearable ? 0 : value\n      }\n\n      return {\n        onMouseenter: props.hover ? onMouseenter : undefined,\n        onMouseleave: props.hover ? onMouseleave : undefined,\n        onFocus,\n        onBlur,\n        onClick,\n      }\n    }))\n\n    function onMousedown () {\n      isClicking = true\n    }\n\n    function onMouseup () {\n      isClicking = false\n    }\n\n    const name = computed(() => props.name ?? `v-rating-${getUid()}`)\n\n    function VRatingItem ({ value, index, showStar = true }: { value: number, index: number, showStar?: boolean }) {\n      const { onMouseenter, onMouseleave, onFocus, onBlur, onClick } = eventState.value[index + 1]\n      const id = `${name.value}-${String(value).replace('.', '-')}`\n      const btnProps = {\n        color: itemState.value[index]?.color,\n        density: props.density,\n        disabled: props.disabled,\n        icon: itemState.value[index]?.icon,\n        ripple: props.ripple,\n        size: props.size,\n        tag: 'span',\n        variant: 'plain' as Variant,\n      }\n\n      return (\n        <>\n          <label\n            for={ id }\n            class={{\n              'v-rating__item--half': props.halfIncrements && value % 1 > 0,\n              'v-rating__item--full': props.halfIncrements && value % 1 === 0,\n            }}\n            onMousedown={ onMousedown }\n            onMouseup={ onMouseup }\n            onMouseenter={ onMouseenter }\n            onMouseleave={ onMouseleave }\n          >\n            <span class=\"v-rating__hidden\">{ t(props.itemAriaLabel, value, props.length) }</span>\n            {\n              !showStar ? undefined\n              : slots.item ? slots.item({\n                ...itemState.value[index],\n                props: btnProps,\n                value,\n                index,\n              })\n              : (\n                <VBtn { ...btnProps } />\n              )\n            }\n          </label>\n\n          <input\n            class=\"v-rating__hidden\"\n            name={ name.value }\n            id={ id }\n            type=\"radio\"\n            value={ value }\n            checked={ normalizedValue.value === value }\n            onClick={ onClick }\n            onFocus={ onFocus }\n            onBlur={ onBlur }\n            ref={ index === 0 ? firstRef : undefined }\n            readonly={ props.readonly }\n            disabled={ props.disabled }\n          />\n        </>\n      )\n    }\n\n    function createLabel (labelProps: { value: number, index: number, label?: string }) {\n      if (slots['item-label']) return slots['item-label'](labelProps)\n\n      if (labelProps.label) return <span>{ labelProps.label }</span>\n\n      return <span>&nbsp;</span>\n    }\n\n    useRender(() => {\n      const hasLabels = !!props.itemLabels?.length || slots['item-label']\n\n      return (\n        <props.tag\n          class={[\n            'v-rating',\n            {\n              'v-rating--hover': props.hover,\n              'v-rating--readonly': props.readonly,\n            },\n            themeClasses.value,\n          ]}\n        >\n          <VRatingItem value={ 0 } index={ -1 } showStar={ false } />\n\n          { range.value.map((value, i) => (\n            <div class=\"v-rating__wrapper\">\n              {\n                hasLabels && props.itemLabelPosition === 'top'\n                  ? createLabel({ value, index: i, label: props.itemLabels?.[i] })\n                  : undefined\n              }\n              <div\n                class={[\n                  'v-rating__item',\n                  {\n                    'v-rating__item--focused': Math.ceil(focusIndex.value) === value,\n                  },\n                ]}\n              >\n                { props.halfIncrements ? (\n                  <>\n                    <VRatingItem value={ value - 0.5 } index={ i * 2 } />\n                    <VRatingItem value={ value } index={ (i * 2) + 1 } />\n                  </>\n                ) : (\n                  <VRatingItem value={ value } index={ i } />\n                )}\n              </div>\n              {\n                hasLabels && props.itemLabelPosition === 'bottom'\n                  ? createLabel({ value, index: i, label: props.itemLabels?.[i] })\n                  : undefined\n              }\n            </div>\n          ))}\n        </props.tag>\n      )\n    })\n\n    return {}\n  },\n})\n\nexport type VRating = InstanceType<typeof VRating>\n"]},"metadata":{},"sourceType":"module"}